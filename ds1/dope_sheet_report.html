<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Dope Sheet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* A little custom CSS for finer control */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* A light gray background */
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        h1, h2, h3 {
            font-weight: 700;
        }
        /* Custom styling for the blockquote to match the original feel */
        .soundbite-quote {
            border-left: 4px solid #e2e8f0;
            padding-left: 1rem;
            margin-top: 0rem; /* Adjusted for new layout */
            font-style: italic;
            color: #475569;
        }
    </style>
</head>
<body class="text-slate-800">

    <header class="bg-gray-800 text-white py-3 px-6 flex items-center justify-between border-b-4 border-sky-500">
        <div class="flex items-center gap-4">
            <img src="Newspath logo.PNG" alt="CBS Newspath Now Logo" class="h-10">
            <span class="text-xl font-medium text-gray-200 hidden sm:block">Dope Sheets</span>
        </div>
        
        <div class="flex items-baseline gap-2"> 
            <span class="text-sm text-gray-400 relative top-[5px]">powered by</span> <img src="VideoShipLogo@2x.png" alt="VideoShip Logo" class="h-8 self-center">
            <span class="text-base font-medium text-gray-300 italic relative top-[5px]">MediaLab</span> </div>
    </header>

    <div id="dope-sheet-container" class="max-w-4xl mx-auto p-4 sm:p-6 md:p-8">
        </div>

    <script>
        // --- DATA SOURCE ---
        const dopeSheetData = {
  "export_thumbnail": {
    "frame": 1475,
    "sec": 49.215
  },
  "headline": "Star-Studded Cast Premieres Wes Anderson's Phoenician Scheme",
  "summary": "An ensemble A-list cast including Benicio del Toro and Mia Threpleton celebrates the New York premiere of Wes Anderson's latest film.",
  "tone_tags": [
    "celebratory",
    "polished", 
    "glamorous"
  ],
  "synopsis": "The Phoenician Scheme premiered in New York with an impressive A-list ensemble cast walking the red carpet. Benicio del Toro stars as Zsa Zsa Korda, one of Europe's richest men who lives without citizenship or traditional attachments, focused solely on winning and staying on top. The film marks a breakout role for Mia Threpleton, Kate Winslet's real-life daughter, who plays Liesel, Korda's nun daughter and sole heir to his estate.\n\nDirector Wes Anderson explores his recurring theme of dysfunctional families through the relationship between father and daughter. The veteran cast, including Scarlett Johansson, Tom Hanks, and Bryan Cranston, praised Anderson's collaborative approach and family-like atmosphere on set. Michael Cera makes his Wes Anderson debut as a Norwegian tutor, describing the film as an old-school adventure romp through Anderson's distinctive visual world.",
  "topic_tags": [
    "film premiere",
    "Wes Anderson",
    "celebrity interviews", 
    "red carpet",
    "ensemble cast",
    "family drama",
    "Focus Features",
    "New York premiere"
  ],
  "chapters": [
    {
      "title": "Red Carpet Arrivals",
      "description": "A-list cast members arrive at The Phoenician Scheme premiere in New York.",
      "representative_keyframe": {
        "frame": 35,
        "sec": 1.168
      },
      "chapter_in_point": {
        "frame": 49,
        "sec": 1.635
      },
      "chapter_out_point": {
        "frame": 238,
        "sec": 7.941
      },
      "sound_bites": []
    },
    {
      "title": "Benicio del Toro Character",
      "description": "Del Toro discusses his role as the wealthy, stateless businessman Zsa Zsa Korda.",
      "representative_keyframe": {
        "frame": 450,
        "sec": 15.015
      },
      "chapter_in_point": {
        "frame": 399,
        "sec": 13.313
      },
      "chapter_out_point": {
        "frame": 955,
        "sec": 31.865
      },
      "sound_bites": []
    },
    {
      "title": "Mia Threpleton Breakout Role",
      "description": "Kate Winslet's daughter discusses her character Liesel, a determined nun and sole heir.",
      "representative_keyframe": {
        "frame": 1475,
        "sec": 49.215
      },
      "chapter_in_point": {
        "frame": 973,
        "sec": 32.466
      },
      "chapter_out_point": {
        "frame": 1640,
        "sec": 54.721
      },
      "sound_bites": [
        {
          "text": "She's very no-nonsense. She means business and she is not about to to be pushed aside or not get the answer that she's asking for from her father.",
          "speaker_name": "Mia Threpleton",
          "in_point_frame": 1318,
          "in_point": "00:43.978",
          "out_point_frame": 1652,
          "out_point": "00:55.114"
        }
      ]
    },
    {
      "title": "Wes Anderson Direction",
      "description": "The director explains the family dynamics and themes in his latest film.",
      "representative_keyframe": {
        "frame": 2080,
        "sec": 69.412
      },
      "chapter_in_point": {
        "frame": 1638,
        "sec": 54.655
      },
      "chapter_out_point": {
        "frame": 2341,
        "sec": 78.145
      },
      "sound_bites": [
        {
          "text": "...his whole business plan is really a mechanism for him to get back together with her.",
          "speaker_name": "Wes Anderson",
          "in_point_frame": 2185,
          "in_point": "01:12.931",
          "out_point_frame": 2348,
          "out_point": "01:18.385"
        }
      ]
    },
    {
      "title": "Cast Collaboration Experience",
      "description": "Bryan Cranston describes the family-like atmosphere Anderson creates on set.",
      "representative_keyframe": {
        "frame": 3100,
        "sec": 103.443
      },
      "chapter_in_point": {
        "frame": 2339,
        "sec": 78.045
      },
      "chapter_out_point": {
        "frame": 3413,
        "sec": 113.914
      },
      "sound_bites": [
        {
          "text": "You go back to the hotel, shower, clean up, and then go downstairs and there's a bar and there's a a long table where all the actors and Wes and the writers and producers, we all sit down and we have dinner together.",
          "speaker_name": "Bryan Cranston",
          "in_point_frame": 2944,
          "in_point": "01:38.258",
          "out_point_frame": 3419,
          "out_point": "01:54.081"
        }
      ]
    },
    {
      "title": "Michael Cera Adventure Film",
      "description": "Cera describes his first Wes Anderson film as an old-school adventure romp.",
      "representative_keyframe": {
        "frame": 3770,
        "sec": 125.806
      },
      "chapter_in_point": {
        "frame": 3652,
        "sec": 121.888
      },
      "chapter_out_point": {
        "frame": 4117,
        "sec": 137.398
      },
      "sound_bites": [
        {
          "text": "It's like an adventure movie. It's like an old school, you know, romp through this world. So I think it's a fun ride.",
          "speaker_name": "Michael Cera",
          "in_point_frame": 3655,
          "in_point": "02:01.965",
          "out_point_frame": 3889,
          "out_point": "02:09.763"
        }
      ]
    }
  ],
  "key_entities": [
    {
      "name": "Benicio Del Toro",
      "keyframe_image": {
        "frame": 782,
        "sec": 26.091
      },
      "bounding_box": {
        "width": 250,
        "height": 250,
        "x": 372,
        "y": 156
      },
      "entity_role": "subject",
      "entity_flags": ["subject"],
      "details": [
        "Plays Zsa Zsa Korda, one of the richest men in Europe",
        "Character described as stateless and citizenship-free",
        "Portrays a one-dimensional bully focused on winning"
      ]
    },
    {
      "name": "Mia Threpleton",
      "keyframe_image": {
        "frame": 1400,
        "sec": 46.713
      },
      "bounding_box": {
        "width": 240,
        "height": 240,
        "x": 480,
        "y": 275
      },
      "entity_role": "subject", 
      "entity_flags": ["subject"],
      "details": [
        "Kate Winslet's real-life daughter in breakout role",
        "Plays Liesel, a nun and Korda's only daughter",
        "Character is sole heir to her father's estate",
        "Described as very no-nonsense and business-focused"
      ]
    },
    {
      "name": "Wes Anderson",
      "keyframe_image": {
        "frame": 1725,
        "sec": 57.558
      },
      "bounding_box": {
        "width": 200,
        "height": 200,
        "x": 490,
        "y": 240
      },
      "entity_role": "subject",
      "entity_flags": ["subject", "director"],
      "details": [
        "Film director known for distinctive visual storytelling style",
        "Explores recurring theme of dysfunctional families",
        "Creates family-like atmosphere for cast on set"
      ]
    },
    {
      "name": "Bryan Cranston",
      "keyframe_image": {
        "frame": 2862,
        "sec": 95.515
      },
      "bounding_box": {
        "width": 260,
        "height": 260,
        "x": 405,
        "y": 200
      },
      "entity_role": "subject",
      "entity_flags": ["subject"],
      "details": [
        "Veteran actor in his third Wes Anderson film",
        "Describes collaborative dinner gatherings with cast and crew",
        "Emphasizes family-like bonds formed during production"
      ]
    },
    {
      "name": "Michael Cera",
      "keyframe_image": {
        "frame": 3670,
        "sec": 122.469
      },
      "bounding_box": {
        "width": 220,
        "height": 220,
        "x": 420,
        "y": 210
      },
      "entity_role": "subject",
      "entity_flags": ["subject"],
      "details": [
        "Plays Norwegian tutor in his first Wes Anderson film",
        "Describes film as old-school adventure movie",
        "Calls it a fun romp through Anderson's world"
      ]
    },
    {
      "name": "Taylor Macy",
      "keyframe_image": {
        "frame": 2225,
        "sec": 74.269
      },
      "bounding_box": {
        "width": 280,
        "height": 280,
        "x": 498,
        "y": 145
      },
      "entity_role": "journalist",
      "affiliation": "CBS News",
      "entity_flags": ["journalist", "narrator"],
      "details": [
        "Role: Journalist narrator",
        "Affiliation: CBS News",
        "Contribution: Provides story narration and red carpet coverage"
      ]
    }
  ]
};

        const isJournalist = (e) =>
            e?.entity_role === "journalist" || e?.entity_flags?.includes("journalist");

        // --- DYNAMIC PAGE BUILDER ---
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('dope-sheet-container');
            if (!container || !dopeSheetData) {
                console.error("Container or data not found!");
                return;
            }

            // --- NEW: Separate the journalist from other entities ---
            const journalistEntity = (dopeSheetData.key_entities || []).find(isJournalist);
            const regularEntities  = (dopeSheetData.key_entities || []).filter(e => !isJournalist(e));

            const entityImageMap = new Map();
            dopeSheetData.key_entities.forEach((entity, index) => {
                const imageUrl = `entity_${index + 1}.jpg`;
                entityImageMap.set(entity.name, imageUrl);
            });

            document.title = dopeSheetData.headline || 'Interactive Dope Sheet';
            const formatSynopsis = (text) => text.split('\n\n').map(p => `<p class="mb-4">${p}</p>`).join('');
            const descriptiveTags = dopeSheetData.descriptive_tags || dopeSheetData.tone_tags || [];

            // --- UPDATED: This entire innerHTML block is new ---
            container.innerHTML = `
                <header class="mb-12">
                    <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2">${dopeSheetData.headline}</h1>
                    <p class="text-lg text-slate-600 italic">${dopeSheetData.summary}</p>
                    ${ (descriptiveTags.length > 0) ? `<div class="flex items-center gap-2 text-sm text-slate-500 font-medium mt-3">${descriptiveTags.map(tag => `<span>${tag}</span>`).join('<span class="mx-1">&middot;</span>')}</div>` : '' }

                <main>
                    <section id="video-player-container" class="mb-8">
                        <video id="main-video" controls class="w-full rounded-lg shadow-lg bg-black" poster="thumbnail.jpg">
                            <source src="video2.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </section>

                    <section id="synopsis" class="mb-8 bg-white p-6 rounded-lg shadow-sm">
                        <h2 class="text-2xl font-bold border-b pb-2 mb-4">Synopsis</h2>
                        <div>${formatSynopsis(dopeSheetData.synopsis)}</div>
                    </section>

                    <section id="topic-tags" class="mb-8">
                        <h2 class="text-2xl font-bold border-b pb-2 mb-4">Topic Tags</h2>
                        <div class="flex flex-wrap gap-2">${dopeSheetData.topic_tags.map(tag => `<span class="bg-sky-100 text-sky-800 text-sm font-medium px-3 py-1 rounded-full">${tag}</span>`).join('')}</div>
                    </section>
                    
                    ${journalistEntity ? `
                    <section id="journalist" class="mb-8">
                    <h2 class="text-2xl font-bold border-b pb-2 mb-4">Journalist</h2>
                    <div class="bg-white p-4 rounded-lg shadow-sm flex items-center gap-5">
                        ${journalistEntity.keyframe_image ? `
                        <img src="entity_${dopeSheetData.key_entities.indexOf(journalistEntity) + 1}.jpg"
                            alt="${journalistEntity.name}"
                            class="w-20 h-20 rounded-full object-cover bg-slate-200 flex-shrink-0">
                        ` : ''}

                        <div class="flex-grow">
                        <div class="flex items-center gap-2 flex-wrap">
                            <h3 class="font-bold text-lg text-slate-900">${journalistEntity.name}</h3>
                            <span class="text-xs uppercase tracking-wide px-2 py-1 rounded-full bg-slate-800 text-white">Journalist</span>
                            ${journalistEntity.affiliation ? `
                            <span class="text-xs px-2 py-1 rounded-full bg-sky-100 text-sky-800">
                                ${journalistEntity.affiliation}
                            </span>` : `
                            <span class="text-xs px-2 py-1 rounded-full bg-amber-100 text-amber-800">
                                Affiliation: Unknown
                            </span>`}
                        </div>

                        <ul class="w-full text-sm text-slate-600 mt-2 list-disc list-outside ml-4 text-left">
                            ${ (journalistEntity.details || []).map(detail => `<li>${detail}</li>`).join('') }
                        </ul>
                        </div>
                    </div>
                    </section>
                    ` : '' }

                    ${regularEntities.length > 0 ? `
                    <section id="key-entities" class="mb-8">
                        <h2 class="text-2xl font-bold border-b pb-2 mb-4">Main Characters</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                            ${regularEntities.map(entity => {
                                const originalIndex = dopeSheetData.key_entities.indexOf(entity);
                                return `
                                <div class="bg-white p-4 rounded-lg shadow-sm flex flex-col items-center text-center">
                                    <img src="entity_${originalIndex + 1}.jpg" alt="${entity.name}" class="w-24 h-24 rounded-full mb-3 object-cover bg-slate-200">
                                    <div class="flex items-center gap-2 flex-wrap">
                                        <h3 class="font-bold text-lg text-slate-900">${entity.name}</h3>
                                        ${entity.entity_role ? `<span class="text-xs px-2 py-1 rounded-full bg-slate-100 text-slate-700">
                                            ${entity.entity_role}
                                        </span>` : ''}
                                        </div>
                                    <ul class="text-sm text-slate-600 mt-2 list-disc list-outside text-left ps-8">${entity.details.map(detail => `<li>${detail}</li>`).join('')}</ul>
                                </div>
                            `}).join('')}
                        </div>
                    </section>
                    ` : ''}
                    
                    <section id="key-chapters">
                        <h2 class="text-2xl font-bold border-b pb-2 mb-4">Story Beats</h2>
                        <div class="space-y-6">
                            ${dopeSheetData.chapters.map((chapter, index) => `
                                <div class="key-chapter bg-white p-4 rounded-lg shadow-sm flex flex-col md:flex-row gap-4 items-start">
                                    <div class="w-full md:w-1/3 flex-shrink-0">
                                        <video id="chapter-video-${index}" class="chapter-video w-full rounded-md cursor-pointer bg-black"
                                            poster="chapter_${index + 1}.jpg"
                                            preload="metadata" muted loop
                                            data-video-id="chapter-video-${index}"
                                            data-start-time="${chapter.chapter_in_point.sec}">
                                            <source src="video2.mp4" type="video/mp4">
                                        </video>
                                    </div>
                                    <div class="key-chapter-text flex-grow">
                                        <h3 class="timestamp-link text-lg font-semibold text-sky-700 hover:text-sky-900 cursor-pointer" 
                                            data-video-id="chapter-video-${index}" 
                                            data-start-time="${chapter.chapter_in_point.sec}">
                                            ${chapter.title}
                                        </h3>
                                        <p class="text-slate-600 mt-1">${chapter.description}</p>
                                        ${chapter.sound_bites.map(sb => `
                                            <figure class="mt-4">
                                                <blockquote class="soundbite-quote m-0 p-0 border-l-4 border-slate-200 pl-3">
                                                    <p>"${sb.text}"</p>
                                                </blockquote>
                                                <figcaption class="text-right text-sm font-semibold text-slate-700 mt-1">- ${sb.speaker_name}</figcaption>
                                            </figure>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </section>
                </main>
            `;
            
            setupVideoInteractivity();
        });

        function setupVideoInteractivity() {
            const mainVideo = document.getElementById('main-video');
            
            // This will keep track of which chapter thumbnail was clicked
            let lastClickedchapterVideo = null;

            // When the main video finishes playing, reset the last clicked thumbnail to show its poster
            mainVideo.addEventListener('ended', () => {
                if (lastClickedchapterVideo) {
                    lastClickedchapterVideo.load(); // .load() resets the video element to its initial state
                    lastClickedchapterVideo = null; // Clear the tracker
                }
            });

            // Handle clicks on any key chapter title or thumbnail
            document.getElementById('key-chapters').addEventListener('click', (event) => {
                const target = event.target.closest('.timestamp-link, .chapter-video');
                if (!target) return;

                // Find the specific <video> element for the chapter that was clicked
                const clickedVideoId = target.dataset.videoId;
                if (!clickedVideoId) return;
                
                const clickedVideoElement = document.getElementById(clickedVideoId);
                
                // If another chapter's playback was triggered previously, reset its thumbnail first
                if (lastClickedchapterVideo && lastClickedchapterVideo !== clickedVideoElement) {
                     lastClickedchapterVideo.load();
                }

                // Store a reference to the new chapter video that was clicked
                lastClickedchapterVideo = clickedVideoElement;

                // Get the start time from the element's data attribute
                const startTime = parseFloat(target.dataset.startTime);
                
                // Jump the main video to the correct time and play
                mainVideo.currentTime = startTime;
                mainVideo.play();

                // Bring the main video into view for the user for a better experience
                mainVideo.scrollIntoView({ behavior: 'smooth', block: 'center' });
            });
        }
    </script>

</body>
</html>